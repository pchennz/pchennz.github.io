(this["webpackJsonp@mdiary/app-client"]=this["webpackJsonp@mdiary/app-client"]||[]).push([[0],{52:function(e,t,n){e.exports=n(67)},57:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"Container",(function(){return x})),n.d(r,"Left",(function(){return O})),n.d(r,"Right",(function(){return w})),n.d(r,"LeftRight",(function(){return T})),n.d(r,"Tabs",(function(){return k})),n.d(r,"Title",(function(){return L}));var a={};n.r(a),n.d(a,"Text",(function(){return W})),n.d(a,"TextButton",(function(){return P})),n.d(a,"TextRange",(function(){return J})),n.d(a,"SelectButtons",(function(){return N})),n.d(a,"SelectCheckboxes",(function(){return G}));var o={};n.r(o),n.d(o,"Actions",(function(){return X})),n.d(o,"Confirmation",(function(){return $})),n.d(o,"Container",(function(){return ee}));var i=n(0),c=n.n(i),l=n(19),s=n.n(l),d=(n(57),n(1)),u=n(17),f=n(5);function p(e,t){e.measure((function(){return t({x:arguments.length<=0?void 0:arguments[0],y:arguments.length<=1?void 0:arguments[1],width:arguments.length<=2?void 0:arguments[2],height:arguments.length<=3?void 0:arguments[3]})}))}var b=n(30),h=n.n(b),m=n(32),g=n(33),y=n.n(g);function x(e){var t=e.style,n=e.children;return c.a.createElement(u.a,{style:[v.container,t]},c.a.createElement(u.a,{style:v.inner},n))}var v=f.a.create({container:{position:"fixed",top:0,left:10,right:10,display:"flex",flexDirection:"row",justifyContent:"center",zIndex:1},inner:{margin:0,padding:0,width:"100%",maxWidth:960,backgroundColor:"#fff",borderTopWidth:5,borderBottomWidth:2,borderColor:"#eee"}});function O(e){var t=e.style,n=e.children;return c.a.createElement(u.a,{style:[E.headerLeft,t]},n)}var E=f.a.create({headerLeft:{display:"flex",flexDirection:"row"}});function w(e){var t=e.style,n=e.children;return c.a.createElement(u.a,{style:[j.headerRight,t]},n)}var j=f.a.create({headerRight:{display:"flex",flexDirection:"row"}});function T(e){var t=e.style,n=e.children;return c.a.createElement(u.a,{style:[S.leftRight,t]},n)}var S=f.a.create({leftRight:{width:"100%",paddingLeft:15,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}}),C=n(69),I=c.a.forwardRef((function(e,t){var n=e.style,r=e.label,a=e.isSelected,o=e.onPress,l=Object(i.useState)(!1),s=Object(d.a)(l,2),u=s[0],f=s[1];return c.a.createElement(C.a,{style:[R.tab,n,u&&R.tabHasHover,a&&R.tabIsSelected],ref:t,onMouseEnter:function(){return f(!0)},onMouseLeave:function(){return f(!1)},onPress:o},r)})),R=f.a.create({tab:{paddingTop:20,paddingBottom:20,paddingLeft:15,paddingRight:15,fontSize:16,fontWeight:"bold",color:"#666",cursor:"pointer",transition:"background-color 0.5s ease"},tabHasHover:{backgroundColor:"#f0f0f0"},tabIsSelected:{backgroundColor:"none",transition:"none",cursor:"none"}});function k(e){var t=e.style,n=e.labels,r=e.selectedIndex,a=e.onChangeTab,o=n.map((function(){return function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=Object(i.useState)({}),n=Object(d.a)(t,2),r=n[0],a=n[1],o=Object(i.useState)(null),c=Object(d.a)(o,2),l=c[0],s=c[1],u=Object(i.useCallback)((function(e){return s(e)}),[]);return Object(i.useLayoutEffect)((function(){function t(){p(l,a)}if(l&&(t(),e))return window.addEventListener("resize",t),window.addEventListener("scroll",t),function(){window.removeEventListener("resize",t),window.removeEventListener("scroll",t)}}),[l]),[u,r]}()})),l=o[r]&&o[r][1];return c.a.createElement(u.a,{style:[D.tabs,t]},c.a.createElement(u.a,{style:D.tabsListWrapper},n.map((function(e,t){return c.a.createElement(I,{label:e,isSelected:t===r,onPress:function(){return t!==r&&a(t)},key:"label-".concat(t),ref:o[t][0]})}))),c.a.createElement(u.a,{style:[D.tabsSelectHighlight,{transform:["translate(".concat(l.x,"px, 0)"),"scale(".concat(l.width/10,","),"".concat(l.height/10,")")].join("")}]}))}var D=f.a.create({tabs:{position:"static",marginTop:10,marginLeft:15},tabsListWrapper:{display:"flex",flexDirection:"row",zIndex:1},tabsSelectHighlight:{position:"absolute",left:15,bottom:0,width:10,height:10,backgroundColor:"yellowgreen",transformOrigin:"bottom left",transition:"transform 0.5s ease"}});function L(e){var t=e.style,n=e.children;return c.a.createElement(C.a,{style:[z.title,t]},n)}var z=f.a.create({title:{marginLeft:10,fontSize:20}}),H=n(72);function q(e){var t=e.style,n=e.labelText,r=e.isRequired,a=e.isHidden,o=e.children;return c.a.createElement(u.a,{style:[F.row,t,a?F.rowIsHidden:{}]},c.a.createElement(C.a,{style:F.label},n,n&&r&&c.a.createElement(C.a,{style:F.labelIsRequired},"*"),n&&":"),o)}var F=f.a.create({row:{paddingTop:20,paddingLeft:15,backgroundColor:"white",fontSize:16,display:"flex",flexDirection:"row",transition:"transform 0.5s ease"},rowIsHidden:{paddingTop:0,height:0,transform:"translate(0, -100%)"},label:{paddingTop:6,paddingRight:12,minWidth:150,fontSize:16},labelIsRequired:{paddingLeft:2,paddingRight:2,color:"tomato"}});function W(e){var t=e.style,n=e.labelText,r=e.isRequired,a=e.isHidden,o=e.placeholder,i=e.value,l=e.extraText,s=e.onChangeText;return c.a.createElement(q,{style:t,labelText:n,isRequired:r,isHidden:a},c.a.createElement(H.a,{style:B.input,placeholder:o,value:i,onChangeText:s}),c.a.createElement(C.a,{style:B.extraText},l))}var B=f.a.create({input:{padding:10,paddingTop:6,paddingBottom:6,borderWidth:1,borderColor:"#eee",fontSize:16},extraText:{paddingTop:6,paddingLeft:12,fontSize:16,color:"#ccc"}});function P(e){var t=e.style,n=e.hoverStyle,r=e.isDisabled,a=e.onPress,o=e.children,l=Object(i.useState)(!1),s=Object(d.a)(l,2),u=s[0],f=s[1];return c.a.createElement(C.a,{style:[A.textButton,u&&A.buttonHasHover,t,u&&n,r&&A.buttonIsDisabled],onMouseEnter:function(){return f(!0)},onMouseLeave:function(){return f(!1)},onPress:function(e){return!r&&a(e)}},o)}var A=f.a.create({textButton:{padding:5,textAlign:"center",justifyContent:"center",borderWidth:"1px",borderColor:"#ccc",cursor:"pointer",transition:"opacity 0.5s ease, background-color 0.5s ease, border-color 0.5s ease"},buttonHasHover:{opacity:"0.8"},buttonIsDisabled:{opacity:"0.5"}});function J(e){var t=e.style,n=e.labelText,r=e.isRequired,a=e.isHidden,o=e.placeholders,i=e.extraText,l=e.values,s=e.onChange;return c.a.createElement(q,{style:t,labelText:n,isRequired:r,isHidden:a},c.a.createElement(u.a,{style:M.inputsWrapper},c.a.createElement(H.a,{style:M.input,placeholder:o&&o.length&&o[0],value:l.length&&l[0],onChangeText:function(e){return s([e,l[1]])}}),c.a.createElement(C.a,{style:M.dash},"-"),c.a.createElement(H.a,{style:M.input,placeholder:o&&o.length>1&&o[1],value:l.length&&l[1],onChangeText:function(e){return s([l[0],e])}}),c.a.createElement(C.a,{style:M.extraText},i)))}P.styles=A;var M=f.a.create({inputsWrapper:{display:"flex",flexDirection:"row",flexWrap:"wrap",flex:1},input:{padding:10,paddingTop:6,paddingBottom:6,borderWidth:1,borderColor:"#eee",fontSize:16},dash:{padding:6,fontSize:16,color:"#999"},extraText:{paddingTop:6,paddingLeft:12,fontSize:16,color:"#ccc"}});function N(e){var t=e.style,n=e.labelText,r=e.isRequired,a=e.isHidden,o=e.options,i=e.selectedIndex,l=e.onChange;return c.a.createElement(q,{style:t,labelText:n,isRequired:r,isHidden:a},o.map((function(e,t){return c.a.createElement(P,{style:[U.button,t===i&&U.buttonIsSelected],onPress:function(){return t!==i&&l(t)},key:"button-".concat(t)},e)})))}var U=f.a.create({button:{padding:10,paddingTop:6,paddingBottom:6,borderWidth:1,borderColor:"#eee"},buttonIsSelected:{borderColor:"yellowgreen",backgroundColor:"yellowgreen",opacity:"1"}}),V=n(51),K=n(70);function G(e){var t=e.style,n=e.labelText,r=e.isRequired,a=e.isHidden,o=e.options,i=e.selectedIndexes,l=e.isSingular,s=e.onChange;return c.a.createElement(q,{style:t,labelText:n,isRequired:r,isHidden:a},o.map((function(e,t){return c.a.createElement(u.a,{style:Q.group,key:"box-".concat(t)},c.a.createElement(K.a,{style:Q.checkbox,value:i.length===o.length&&i[t],onValueChange:function(e){var n=l?i.map((function(){return!1})):Object(V.a)(i);n[t]=e,s(n)}}),c.a.createElement(C.a,{style:Q.text},e))})))}var Q=f.a.create({group:{display:"flex",flexDirection:"row",marginRight:12},checkbox:{marginRight:8,width:24,height:24},text:{paddingTop:2,fontSize:16}});function X(e){var t=e.actions,n=e.isDisabled,r=e.onAction;return c.a.createElement(u.a,{style:Y.wrapper},c.a.createElement(a.TextButton,{style:[Y.button,Y.actionPrimary],isDisabled:n,onPress:function(){return r(0)}},t[0]),c.a.createElement(u.a,{style:Y.wrapperRight},t.slice(1).map((function(e,t){return c.a.createElement(a.TextButton,{style:[Y.button,Y.actionOthers],hoverStyle:{backgroundColor:"#f7f7f7"},isDisabled:n,onPress:function(){return r(t+1)},key:"action-".concat(t)},e)}))))}var Y=f.a.create({wrapper:{marginTop:30,display:"flex",flexDirection:"row",justifyContent:"space-between"},wrapperRight:{display:"flex",flexDirection:"row"},button:{padding:15,fontSize:20,borderRadius:5,cursor:"pointer"},actionPrimary:{backgroundColor:"dodgerblue",border:"none",color:"white"},actionOthers:{marginLeft:10,backgroundColor:"white",borderColor:"#ccc",color:"#999"}}),Z=n(71);function $(e){var t=e.isLoading,n=e.hasError,r=e.onPress,a=e.children;return c.a.createElement(u.a,{style:[_.wrapper,t?_.wrapperLoading:{},!t&&n?_.wrapperError:{},t||n?{}:_.wrapperSuccess,t||a?_.wrapperVisible:{}],onClick:r},t&&c.a.createElement(Z.a,{size:"small",color:"mediumseagreen"}),!t&&("string"===typeof a?c.a.createElement(C.a,{style:_.text},a):a))}var _=f.a.create({wrapper:{height:0,flexDirection:"row",justifyContent:"center",cursor:"pointer",transition:"transform 0.5s ease, height 0.5s ease",transform:"translate(0, -100%)"},wrapperLoading:{backgroundColor:"#f7f7f7"},wrapperSuccess:{backgroundColor:"mediumseagreen",transition:"background-color 0.5s ease"},wrapperError:{backgroundColor:"moccasin",transition:"background-color 0.5s ease"},wrapperVisible:{padding:10,minHeight:40,height:"default",display:"flex",transform:"translate(0, 0)"},text:{color:"white"}});function ee(e){var t=e.style,n=e.children;return c.a.createElement(u.a,{style:[te.container,t]},n)}var te=f.a.create({container:{margin:15,marginBottom:50,padding:0,paddingTop:120}}),ne=n(2),re="https://7fqtwxm3kf.execute-api.eu-west-1.amazonaws.com/dev/sync-monzo",ae="https://7fqtwxm3kf.execute-api.eu-west-1.amazonaws.com/dev/set-expenses",oe={none:1,holiday:2};function ie(e){var t=e.spreadsheetId,n=e.cachedFields,r=e.isDisabled,l=e.onFetchAction,s=Object(i.useState)(n.sheetId),u=Object(d.a)(s,2),f=u[0],p=u[1],b=Object(i.useState)(["",""]),h=Object(d.a)(b,2),m=h[0],g=h[1],y=Object(i.useState)(oe[n.formatOption]||0),x=Object(d.a)(y,2),v=x[0],O=x[1],E=Object(i.useState)(n.timeDiff),w=Object(d.a)(E,2),j=w[0],T=w[1],S=Object(i.useState)([!1,!1]),C=Object(d.a)(S,2),I=C[0],R=C[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(a.Text,{labelText:"Sheet ID",placeholder:"default: 0",value:f,onChangeText:p}),c.a.createElement(a.TextRange,{labelText:"Date Range",placeholders:["default: previous sync","default: 100 records"],extraText:"(yyyy-mm-dd)",type:"date",values:m,onChange:g}),c.a.createElement(a.SelectButtons,{labelText:"Format",isRequired:!0,style:{zIndex:1},options:["default","dump","holiday mode"],selectedIndex:v,onChange:O}),c.a.createElement(a.Text,{labelText:"",isHidden:2!==v,placeholder:"timezone diff",extraText:"(hours from UK - e.g. 2, 3, -5)",value:j,onChangeText:T}),c.a.createElement(a.SelectCheckboxes,{labelText:"Resolve Previous",options:["confirm","revert"],selectedIndexes:I,isSingular:!0,onChange:R}),c.a.createElement(o.Actions,{actions:["Sync Transactions","Just Confirm","Just Revert"],isDisabled:r,onAction:function(e){var n=Object(ne.a)(Object(ne.a)(Object(ne.a)(Object(ne.a)(Object(ne.a)(Object(ne.a)(Object(ne.a)({userId:"000"},t&&{spreadsheetId:t}),f&&{sheetId:f}),m&&m[0]&&{syncFrom:m[0]}),m&&m[1]&&{syncUntil:m[1]}),1===v&&{formatOption:"none"}),2===v&&{formatOption:"holiday"}),j&&{timeDiff:j}),a=[Object(ne.a)(Object(ne.a)({},I[0]&&{resolveOption:"confirm"}),I[1]&&{resolveOption:"revert"}),{resolveOption:"confirmOnly"},{resolveOption:"revertOnly"}];!r&&function(e){var t=e.spreadsheetId,n=e.sheetId,r=e.syncFrom,a=e.syncUntil,o=e.formatOption,i=e.timeDiff;if(!t)return alert("missing spreadsheetId"),!1;if("holiday"===o){if(!n)return alert("sheetId is required in holiday mode"),!1;if(!i)return alert("timezone diff is required in holiday mode"),!1}var c=/[0-9]{4}-[0-9]{2}-[0-9]{2}/;if(r&&!c.test(r)||a&&!c.test(a))return alert("invalid date range format"),!1;if(i)try{if(!parseFloat(i))return alert("invalid timezone diff format"),!1}catch(l){return alert("invalid timezone diff format"),!1}return!0}(n)&&l({endpoint:re,params:Object(ne.a)(Object(ne.a)({},n),a[e])})}}))}function ce(e){var t=e.spreadsheetId,n=e.cachedFields,r=e.isDisabled,l=e.onFetchAction,s=Object(i.useState)(n.sheetId),u=Object(d.a)(s,2),f=u[0],p=u[1],b=Object(i.useState)(["",""]),h=Object(d.a)(b,2),m=h[0],g=h[1],y=Object(i.useState)([!1,!1]),x=Object(d.a)(y,2),v=x[0],O=x[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(a.Text,{labelText:"Sheet ID",placeholder:"default: 0",value:f,onChangeText:p}),c.a.createElement(a.TextRange,{labelText:"Row Range",placeholders:["default: previous set","default: 30 records"],type:"number",values:m,onChange:g}),c.a.createElement(a.SelectCheckboxes,{labelText:"Resolve Previous",options:["confirm","revert"],selectedIndexes:v,isSingular:!0,onChange:O}),c.a.createElement(o.Actions,{actions:["Set Expenses","Just Confirm","Just Revert"],isDisabled:r,onAction:function(e){var n=Object(ne.a)(Object(ne.a)(Object(ne.a)({userId:"000"},t&&{spreadsheetId:t}),f&&{sheetId:f}),m&&(m[0]||m[1])&&{range:"".concat(m[0],":").concat(m[1])}),a=[Object(ne.a)(Object(ne.a)({},v[0]&&{resolveOption:"confirm"}),v[1]&&{resolveOption:"revert"}),{resolveOption:"confirmOnly"},{resolveOption:"revertOnly"}];!r&&function(e){var t=e.spreadsheetId,n=e.range;if(!t)return alert("missing spreadsheetId"),!1;if(n&&!/[0-9]+:[0-9]+/.test(n))return alert("invalid row range"),!1;return!0}(n)&&l({endpoint:ae,params:Object(ne.a)(Object(ne.a)({},n),a[e])})}}))}function le(){var e=function(e,t){var n=Object(i.useState)((function(){var n=window.localStorage.getItem(e);if(!n)return t;try{return JSON.parse(n)}catch(r){return t}})),r=Object(d.a)(n,2),a=r[0],o=r[1];return Object(i.useEffect)((function(){window.localStorage.setItem(e,"string"===typeof a?a:JSON.stringify(a))}),[a]),[a,o]}("cachedFields",{}),t=Object(d.a)(e,2),n=t[0],l=t[1],s=Object(i.useState)(n.spreadsheetId),f=Object(d.a)(s,2),p=f[0],b=f[1],g=Object(i.useState)(0),x=Object(d.a)(g,2),v=x[0],O=x[1],E=function(){var e=Object(i.useState)(""),t=Object(d.a)(e,2),n=t[0],r=t[1],a=Object(i.useState)(!1),o=Object(d.a)(a,2),c=o[0],l=o[1],s=Object(i.useState)(!1),u=Object(d.a)(s,2),f=u[0],p=u[1];function b(){return(b=Object(m.a)(h.a.mark((function e(t){var n,a,o,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.endpoint,a=t.params,l(!0),e.next=4,fetch("".concat(n,"?").concat(y.a.stringify(a)));case 4:return o=e.sent,e.next=7,o.json();case 7:i=e.sent,r(i),l(!1),p(!o.ok);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return[n,c,f,function(e){return b.apply(this,arguments)},function(){r(""),l(!1),p(!1)}]}(),w=Object(d.a)(E,5),j=w[0],T=w[1],S=w[2],C=w[3],I=w[4];function R(e){var t=e.endpoint,n=e.params;l(n),C({endpoint:t,params:n})}var k="";return j&&(k=j.proxyMonzo?"".concat(j.syncedRowsCount," rows synced"):j.proxyFreeagent?"".concat(j.provisionedRowsCount," rows provisioned"):j.errors?JSON.stringify(j.errors):JSON.stringify(j)),c.a.createElement(u.a,{style:se.app},c.a.createElement(r.Container,null,c.a.createElement(r.LeftRight,null,c.a.createElement(r.Left,null,c.a.createElement(r.Title,null,"M-Diary Client")),c.a.createElement(r.Right,null,c.a.createElement(a.Text,{labelText:"Spreadsheet ID",style:{marginTop:0},placeholder:"required",value:p,onChangeText:b,isRequired:!0}))),c.a.createElement(r.Tabs,{labels:["Sync Transactions","Set Expenses"],selectedIndex:v,onChangeTab:O})),c.a.createElement(o.Container,null,c.a.createElement(o.Confirmation,{isLoading:T,hasError:S,onPress:I},k),0===v&&c.a.createElement(ie,{spreadsheetId:p,cachedFields:n,isDisabled:T,onFetchAction:R}),1===v&&c.a.createElement(ce,{spreadsheetId:p,cachedFields:n,isDisabled:T,onFetchAction:R})))}var se=f.a.create({app:{width:"100%",maxWidth:960,backgroundColor:"white"}});s.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(le,null)),document.getElementById("root"))}},[[52,1,2]]]);